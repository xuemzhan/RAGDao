# D3: 索引策略 (Indexing Strategies)

## **核心挑战：维度诅咒与ANN**

- **维度诅咒 (Curse of Dimensionality):**
    - **说明：** 随着向量维度（特征数量）的增加，高维空间会变得极其稀疏，点与点之间的距离差异变得不再有意义。这使得精确的最近邻搜索变得异常困难且缓慢。
    - **概念出处：** 该术语由Richard E. Bellman在其1957年关于动态规划的研究中首次提出。
- **近似最近邻 (ANN - Approximate Nearest Neighbor):**
    - **说明：** 为了克服维度诅咒，我们不追求100%的精确，而是采用ANN算法，在可接受的精度损失范围内，换取数量级的速度提升。
    - **类比：** 正如之前提到的“在城市里找咖啡馆”，ANN就是那些比遍历全城更智能的策略。

## **主流ANN算法详解**

- **HNSW (Hierarchical Navigable Small World):**
    - **类比：** **城市的多层高速公路系统**。搜索时，从最顶层连接稀疏的“国家级高速”快速跨越区域，然后逐层下降到“省级高速”、“市内快速路”，最后在“地方街道”网络中精确导航。
    - **关键调优参数：**
        - M: 建图时每个节点的最大连接数。M越大，路网越密集，导航选择越多，索引质量越高，但占用内存也越多。
        - ef_construction: 建图时的搜索范围。值越大，建图越慢，但路网连接质量越好。
        - ef_search: 查询时的搜索范围。这是**最重要的运行时参数**，直接控制着速度和精度的平衡。ef_search越大，搜索时探索的“岔路”越多，越准也越慢。
- **IVF (Inverted File):**
    - **类比：** **图书馆的图书分类系统**。所有书（向量）按主题（聚类）分到不同的书架（nlist个簇）。找书时，你只去最可能相关的几个书架（nprobe个簇）里查找。
    - **关键调tuning参数：**
        - nlist: 簇的数量（书架总数）。
        - nprobe: 查询时要搜索的簇的数量（你要去翻找几个书架）。nprobe越小，速度越快，但越可能错过正确答案。

## **向量压缩技术 (Vector Quantization)**

- **PQ & SQ (Product & Scalar Quantization):**
    - **说明：** 这是**向量压缩**技术，旨在通过有损压缩来降低内存占用。
    - **类比：** **将一张高清照片（高精度向量）压缩成JPEG格式（量化后的向量）**。文件大小（内存占用）显著减小，但会损失一些细节（精度）。对于大多数应用场景，这种损失是可接受的。